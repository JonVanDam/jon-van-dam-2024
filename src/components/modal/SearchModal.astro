---
import { Icon } from 'astro-icon/components';
import { slugify, deslugify } from '../../util/util';

const { projectId } = Astro.props;

const getAllProjects = await Astro.glob('../../pages/*/*.md');

const project = getAllProjects.find((project) => {
  const slug = slugify(project.frontmatter.title);
  return slug === projectId;
});

const getAllArticles = await Astro.glob('../../pages/*/*/*.md');

const articles = getAllArticles.filter((article) => {
  return article.url?.includes(projectId);
});
---

<modal id="search-modal" class="search-modal hidden">
  <div class="search-modal-content">
    <div class="p-2 w-full relative">
      <input autofocus class="search-input" placeholder={'Search ' + deslugify(projectId) + '...'} />
      <Icon name="basil:search-outline" class="absolute top-5 left-5 scale-125 pointer-events-none" />
    </div>
    <div class="p-2">
      <ul>
        {
          new Array(5).fill('Hello world hello world').map((test) => {
            return (
              <li class="py-2 px-1">
                <a href="/">{test}</a>
              </li>
            );
          })
        }
      </ul>
    </div>
  </div>
</modal>

<script is:inline>
  // Register click outside of modal -> close modal

  window.addEventListener('click', (evt) => {
    const target = evt.target;

    const modal = document.getElementById('search-modal');

    if (target == modal) {
      modal.classList.add('hidden');
    }
  });
</script>
